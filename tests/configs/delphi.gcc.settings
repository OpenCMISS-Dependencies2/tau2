#!/bin/zsh -e

module load mpi/openmpi-3.1.1_gcc-7.3
module load gcc/7.3
module load python/3.6.8
module load cuda/10.2
BFD=/usr/local/packages/binutils/2.34
PDT=/usr/local/packages/pdtoolkit-3.25.1
OTF2=/usr/local/packages/otf2/2.1
PAPI=/usr/local/packages/papi/6.0.0.1

export CC=gcc
export CXX=g++
export FC=gfortran
export COMPILER=gcc

export TAU_OPTIONS="-optRevert"

declare -a thread_options=("-pthread" "-openmp -opari" "-openmp -ompt")
export thread_options
declare -a mpi_options=("-mpi")
export mpi_options
declare -a python_options=("-python -pythoninc=${PYTHONTOP}/include/python3.6m -pythonlib=${PYTHONTOP}/lib")
export python_options
declare -a papi_options=("-papi=${PAPI}")
export papi_options
declare -a cuda_options=("-cuda=${CUDA} -pthread")
export cuda_options

# Enable the things that Spack enables by default
base_support="-bfd=${BFD} -iowrapper -pdt=${PDT} -pdt_c++=g++ -otf=${OTF2}"

# Which tests to run?
basic_test_programs="mm"
mpi_test_programs="mm"
python_test_programs="python"
cuda_test_programs="cuda openacc"
