#ifdef _POMP2
#  undef _POMP2
#endif
#define _POMP2 200110

#line 1 "test2.f"
! * This file is part of the Score-P software (http://www.score-p.org)
! *
! * Copyright (c) 2009-2011,
! *    RWTH Aachen University, Germany
! *    Gesellschaft fuer numerische Simulation mbH Braunschweig, Germany
! *    Technische Universitaet Dresden, Germany
! *    University of Oregon, Eugene, USA
! *    Forschungszentrum Juelich GmbH, Germany
! *    German Research School for Simulation Sciences GmbH, Juelich/Aachen, Germany
! *    Technische Universitaet Muenchen, Germany
! *
! * See the COPYING file in the package base directory for details.
! *
! * Testfile for automated testing of OPARI2
! *
! * @authors Bernd Mohr, Peter Philippen
! *
! * @brief Test the basic instrumentation of all directives.

      program test2
      include 'test2.f.opari.inc'
      integer i
      integer k
      
      integer, save :: j
#line 25 "test2.f"
!$omp threadprivate(j)

      pomp_num_threads = pomp_get_max_threads000()
      call POMP2_Parallel_fork(pomp2_region_1, pomp_num_threads,
         &"59*regionType=parallel*sscl=test2.f:27:27*escl=test2.f:"//
     &"0:0**" )
#line 27 "test2.f"
!$omp parallel
!$omp& num_threads(pomp_num_threads) 
      call POMP2_Parallel_begin(pomp2_region_1)
#line 28 "test2.f"
      write(*,*) "parallel"
      
      call POMP2_Do_enter(pomp2_region_2,
         &"53*regionType=do*sscl=test2.f:30:30*escl=test2.f:0:0**""//
     &" )
#line 30 "test2.f"
!$omp do
      do i=1,4
         write(*,*) "do",i
         k = k + 1
      enddo
#line 35 "test2.f"
!$omp end do nowait
      call POMP2_Implicit_barrier_enter(pomp2_region_2)
!$omp barrier
      call POMP2_Implicit_barrier_exit(pomp2_region_2)
      call POMP2_Do_exit(pomp2_region_2)
#line 36 "test2.f"
      
      call POMP2_Flush_enter(pomp2_region_3,
         &"56*regionType=flush*sscl=test2.f:37:37*escl=test2.f:0:0"//
     &"**" )
#line 37 "test2.f"
!$omp flush(k)
      call POMP2_Flush_exit(pomp2_region_3)
#line 38 "test2.f"

      call POMP2_Barrier_enter(pomp2_region_4,
         &"58*regionType=barrier*sscl=test2.f:39:39*escl=test2.f:0"//
     &":0**" )
#line 39 "test2.f"
!$omp barrier
      call POMP2_Barrier_exit(pomp2_region_4)
#line 40 "test2.f"

      call POMP2_Do_enter(pomp2_region_5,
         &"53*regionType=do*sscl=test2.f:41:41*escl=test2.f:0:0**""//
     &" )
#line 41 "test2.f"
!$omp do ordered
      do i=1,4
#line 43 "test2.f"
!$omp ordered
         write(*,*) "do",i
#line 45 "test2.f"
!$omp end ordered
      enddo
#line 47 "test2.f"
!$omp end do nowait
      call POMP2_Implicit_barrier_enter(pomp2_region_5)
!$omp barrier
      call POMP2_Implicit_barrier_exit(pomp2_region_5)
      call POMP2_Do_exit(pomp2_region_5)
#line 48 "test2.f"

      call POMP2_Sections_enter(pomp2_region_6,
         &"73*regionType=sections*sscl=test2.f:49:49*escl=test2.f:"//
     &"0:0*numSections=0**" )
#line 49 "test2.f"
!$omp sections
#line 50 "test2.f"
!$omp section
      call POMP2_Section_begin(pomp2_region_6,
         &"73*regionType=sections*sscl=test2.f:49:49*escl=test2.f:"//
     &"0:0*numSections=0**" )
#line 51 "test2.f"
      write(*,*) "section 1"
      call POMP2_Section_end(pomp2_region_6)
#line 52 "test2.f"
!$omp section
      call POMP2_Section_begin(pomp2_region_6,
         &"73*regionType=sections*sscl=test2.f:49:49*escl=test2.f:"//
     &"0:0*numSections=1**" )
#line 53 "test2.f"
      write(*,*) "section 2"
      call POMP2_Section_end(pomp2_region_6)
#line 54 "test2.f"
!$omp end sections nowait
      call POMP2_Implicit_barrier_enter(pomp2_region_6)
!$omp barrier
      call POMP2_Implicit_barrier_exit(pomp2_region_6)
      call POMP2_Sections_exit(pomp2_region_6)
#line 55 "test2.f"
      
#line 56 "test2.f"
!$omp master
      call POMP2_Master_begin(pomp2_region_7,
         &"57*regionType=master*sscl=test2.f:56:56*escl=test2.f:0:"//
     &"0**" )
#line 57 "test2.f"
      write(*,*) "master"
      call POMP2_Master_end(pomp2_region_7)
#line 58 "test2.f"
!$omp end master
      
      call POMP2_Critical_enter(pomp2_region_8,
         &"59*regionType=critical*sscl=test2.f:60:60*escl=test2.f:"//
     &"0:0**" )
#line 60 "test2.f"
!$omp critical
      call POMP2_Critical_begin(pomp2_region_8)
#line 61 "test2.f"
      write(*,*) "critical"
      call POMP2_Critical_end(pomp2_region_8)
#line 62 "test2.f"
!$omp end critical
      call POMP2_Critical_exit(pomp2_region_8)
#line 63 "test2.f"
      
      call POMP2_Critical_enter(pomp2_region_9,
         &"79*regionType=critical*sscl=test2.f:64:64*escl=test2.f:"//
     &"0:0*criticalName=foobar**" )
#line 64 "test2.f"
!$omp critical(foobar)
      call POMP2_Critical_begin(pomp2_region_9)
#line 65 "test2.f"
      write(*,*) "critical(foobar)"
      call POMP2_Critical_end(pomp2_region_9)
#line 66 "test2.f"
!$omp end critical(foobar)
      call POMP2_Critical_exit(pomp2_region_9)
#line 67 "test2.f"
      
      call POMP2_Atomic_enter(pomp2_region_10,
         &"57*regionType=atomic*sscl=test2.f:68:68*escl=test2.f:0:"//
     &"0**" )
#line 68 "test2.f"
!$omp atomic
! do this atomic
      i = i + 1
      call POMP2_Atomic_exit(pomp2_region_10)
#line 71 "test2.f"
      
      call POMP2_Single_enter(pomp2_region_11,
         &"57*regionType=single*sscl=test2.f:72:72*escl=test2.f:0:"//
     &"0**" )
#line 72 "test2.f"
!$omp single
      call POMP2_Single_begin(pomp2_region_11)
#line 73 "test2.f"
      write(*,*) "single"
      call POMP2_Single_end(pomp2_region_11)
#line 74 "test2.f"
!$omp end single nowait
      call POMP2_Implicit_barrier_enter(pomp2_region_11)
!$omp barrier
      call POMP2_Implicit_barrier_exit(pomp2_region_11)
      call POMP2_Single_exit(pomp2_region_11)
#line 75 "test2.f"
      
      call POMP2_Workshare_enter(pomp2_region_12,
         &"60*regionType=workshare*sscl=test2.f:76:76*escl=test2.f"//
     &":0:0**" )
#line 76 "test2.f"
!$omp workshare
      a = b + c
#line 78 "test2.f"
!$omp end workshare nowait
      call POMP2_Implicit_barrier_enter(pomp2_region_12)
!$omp barrier
      call POMP2_Implicit_barrier_exit(pomp2_region_12)
      call POMP2_Workshare_exit(pomp2_region_12)
#line 79 "test2.f"

      call POMP2_Implicit_barrier_enter(pomp2_region_1)
!$omp barrier
      call POMP2_Implicit_barrier_exit(pomp2_region_1)
      call POMP2_Parallel_end(pomp2_region_1)
#line 80 "test2.f"
!$omp end parallel
      call POMP2_Parallel_join(pomp2_region_1)
#line 81 "test2.f"

#line 82 "test2.f"
!$omp this should be ignored by opari and the compiler
!$this too

      end program test2
      

      integer function pomp_get_max_threads000()
         integer omp_get_max_threads
         pomp_get_max_threads000=omp_get_max_threads()
         return
      end

      subroutine POMP2_Init_regions_000()
         include 'test2.f.opari.inc'
         call POMP2_Assign_handle( pomp2_region_1, 
         &"61*regionType=parallel*sscl=test2.f:27:27*escl=test2.f:"//
     &"80:80**" )
         call POMP2_Assign_handle( pomp2_region_2, 
         &"55*regionType=do*sscl=test2.f:30:30*escl=test2.f:35:35*"//
     &"*" )
         call POMP2_Assign_handle( pomp2_region_3, 
         &"56*regionType=flush*sscl=test2.f:37:37*escl=test2.f:0:0"//
     &"**" )
         call POMP2_Assign_handle( pomp2_region_4, 
         &"58*regionType=barrier*sscl=test2.f:39:39*escl=test2.f:0"//
     &":0**" )
         call POMP2_Assign_handle( pomp2_region_5, 
         &"55*regionType=do*sscl=test2.f:41:41*escl=test2.f:47:47*"//
     &"*" )
         call POMP2_Assign_handle( pomp2_region_6, 
         &"75*regionType=sections*sscl=test2.f:49:49*escl=test2.f:"//
     &"54:54*numSections=2**" )
         call POMP2_Assign_handle( pomp2_region_7, 
         &"59*regionType=master*sscl=test2.f:56:56*escl=test2.f:58"//
     &":58**" )
         call POMP2_Assign_handle( pomp2_region_8, 
         &"61*regionType=critical*sscl=test2.f:60:60*escl=test2.f:"//
     &"62:62**" )
         call POMP2_Assign_handle( pomp2_region_9, 
         &"81*regionType=critical*sscl=test2.f:64:64*escl=test2.f:"//
     &"66:66*criticalName=foobar**" )
         call POMP2_Assign_handle( pomp2_region_10, 
         &"59*regionType=atomic*sscl=test2.f:68:68*escl=test2.f:70"//
     &":70**" )
         call POMP2_Assign_handle( pomp2_region_11, 
         &"59*regionType=single*sscl=test2.f:72:72*escl=test2.f:74"//
     &":74**" )
         call POMP2_Assign_handle( pomp2_region_12, 
         &"62*regionType=workshare*sscl=test2.f:76:76*escl=test2.f"//
     &":78:78**" )
      end
